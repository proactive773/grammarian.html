<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ù„ØºÙˆÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
  <!-- Google Fonts - Cairo -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
      color: #333;
      line-height: 1.8;
      padding: 20px;
    }

    .container {
      max-width: 1100px;
      margin: auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    header {
      background: #0052A0;
      color: white;
      text-align: center;
      padding: 30px;
    }

    h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }

    p.subtitle {
      font-size: 16px;
      opacity: 0.9;
    }

    .content {
      padding: 30px;
    }

    label {
      display: block;
      font-weight: bold;
      margin-top: 15px;
      color: #0052A0;
    }

    input[type="text"], select {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-top: 8px;
      font-family: 'Cairo', sans-serif;
    }

    textarea {
      width: 100%;
      padding: 14px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-top: 8px;
      font-family: 'Cairo', sans-serif;
      resize: vertical;
    }

    button {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
      transition: background 0.3s;
      margin-left: 5px;
    }

    button:hover {
      background-color: #005edc;
    }

    .btn-print {
      background-color: #28a745;
    }

    .btn-print:hover {
      background-color: #218838;
    }

    .btn-reset {
      background-color: #dc3545;
    }

    .btn-reset:hover {
      background-color: #c82333;
    }

    .section-title {
      color: #0052A0;
      margin: 25px 0 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #007BFF;
    }

    .roles-container {
      margin-top: 15px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .role-input {
      display: flex;
      gap: 5px;
      align-items: center;
      background: #f8f9ff;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
      flex: 1;
      min-width: 300px;
    }

    .role-input select, .role-input input {
      margin: 0 !important;
      width: auto !important;
      flex: 1;
    }

    .add-role-btn {
      background-color: #28a745;
      padding: 8px 15px;
      font-size: 14px;
    }

    .report {
      margin-top: 30px;
      padding: 25px;
      background-color: #f8f9ff;
      border-radius: 12px;
      border: 1px solid #e0ebff;
      display: none;
    }

    .report h2 {
      color: #0052A0;
      text-align: center;
      margin-bottom: 20px;
      font-size: 22px;
    }

    .section {
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px dashed #ddd;
    }

    .section:last-child {
      border-bottom: none;
    }

    .highlight {
      color: #28a745;
      font-weight: bold;
    }

    .error {
      color: #d32f2f;
    }

    .stats {
      display: flex;
      gap: 15px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .stat-card {
      flex: 1;
      min-width: 180px;
      background: white;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      border: 1px solid #eee;
    }

    .stat-card strong {
      display: block;
      font-size: 24px;
      color: #007BFF;
    }

    ul {
      padding-right: 20px;
    }

    ul li {
      margin: 8px 0;
    }

    .voice-controls {
      margin: 20px 0;
      text-align: center;
    }

    .transcript {
      background: #e9ecef;
      padding: 15px;
      border-radius: 8px;
      margin-top: 10px;
      font-size: 16px;
      min-height: 60px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ù„ØºÙˆÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</h1>
      <p class="subtitle">ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª - Ø±ØµØ¯ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± - ØªØ­Ù„ÙŠÙ„ ØµÙˆØªÙŠ - ØªÙ‚Ø§Ø±ÙŠØ± Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©</p>
    </header>

    <div class="content">
      <label for="selectedWord">Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© Ù„ÙŠÙˆÙ… Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹:</label>
      <input type="text" id="selectedWord" placeholder="Ù…Ø«Ù„: Ø±Ø§Ø¦Ø¹ØŒ ÙŠØ°Ù‡Ø¨ØŒ Ù…Ù‡Ù…...">

      <!-- Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ØªØ­Ø¯Ø«ÙŠÙ† ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Ø± -->
      <label style="margin-top: 25px;">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ØªØ­Ø¯Ø«ÙŠÙ† ÙÙŠ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹:</label>
      <div class="roles-container" id="rolesContainer">
        <div class="role-input">
          <select>
            <option>Ù…ØªØ­Ø¯Ø« 1</option>
            <option>Ù…ØªØ­Ø¯Ø« 2</option>
            <option>Ù…ØªØ­Ø¯Ø« 3</option>
            <option>Ù…ØªØ­Ø¯Ø« 4</option>
          </select>
          <input type="text" placeholder="Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¯ÙˆØ±">
        </div>
      </div>
      <button class="add-role-btn" onclick="addRoleInput()">+ Ø¥Ø¶Ø§ÙØ© Ù…ØªØ­Ø¯Ø« Ø¢Ø®Ø±</button>

      <!-- Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ -->
      <label style="margin-top: 25px;">Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (ØªØ¬Ø±ÙŠØ¨ÙŠ):</label>
      <div class="voice-controls">
        <button onclick="startVoiceRecognition()">ğŸŸ¢ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ</button>
        <button onclick="stopVoiceRecognition()">ğŸ”´ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„</button>
        <p><small>Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØªØ¹Ù…Ù„ ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„ØªÙŠ ØªØ¯Ø¹Ù… Web Speech API (Ù…Ø«Ù„ ÙƒØ±ÙˆÙ…)</small></p>
      </div>
      <div class="transcript" id="transcriptBox">Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø£ÙŠ ÙƒÙ„Ø§Ù… Ø¨Ø¹Ø¯...</div>

      <!-- Ø§Ù„Ù†Øµ Ø§Ù„ÙŠØ¯ÙˆÙŠ -->
      <label for="inputText" style="margin-top: 25px;">Ø£Ùˆ Ø£Ø¯Ø®Ù„ Ù†Øµ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ ÙŠØ¯ÙˆÙŠÙ‹Ø§:</label>
      <textarea id="inputText" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ø¯Ø§Ø®Ù„Ø§Øª Ù‡Ù†Ø§..."></textarea>

      <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„Ø·Ø¨Ø§Ø¹Ø© -->
      <div style="text-align: center; margin-top: 20px;">
        <button onclick="generateFinalReport()">ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ ÙˆØ¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
        <button class="btn-print" onclick="printReport()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
        <button class="btn-reset" onclick="resetAll()">ğŸ—‘ï¸ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒÙ„</button>
      </div>

      <!-- Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
      <div class="report" id="finalReport">
        <h2>ğŸ“Œ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø®ØªØ§Ù…ÙŠ Ù„Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ù„ØºÙˆÙŠ</h2>

        <div class="section">
          <h3 class="section-title">ğŸ“˜ Ø´Ø±Ø­ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©</h3>
          <p id="wordExplanation">Ø³ÙŠØªÙ… Ø´Ø±Ø­ Ù…Ø¹Ù†Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø© ÙˆØ§Ù„Ø³ÙŠØ§Ù‚ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§.</p>
        </div>

        <div class="section">
          <h3 class="section-title">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3>
          <p id="wordUsageCount">Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©.</p>
          <div id="synonymUsage"></div>
          <div class="stats" id="usageStats"></div>
        </div>

        <div class="section">
          <h3 class="section-title">ğŸ‘¥ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙ„Ù…Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…ØªØ­Ø¯Ø«ÙŠÙ†</h3>
          <ul id="roleUsage"></ul>
        </div>

        <div class="section">
          <h3 class="section-title">âœ… Ø£Ø¨Ø±Ø² Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª Ø§Ù„Ø¬ÙŠØ¯Ø©</h3>
          <ul id="goodUsages"></ul>
        </div>

        <div class="section">
          <h3 class="section-title">âŒ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù„ØºÙˆÙŠØ©</h3>
          <ul id="linguisticIssues"></ul>
        </div>

        <div class="section">
          <h3 class="section-title">ğŸ¯ Ø§Ù„ØªÙˆØµÙŠØ§Øª Ù„Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ Ø§Ù„Ù‚Ø§Ø¯Ù…</h3>
          <ul>
            <li>ØªØ´Ø¬ÙŠØ¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø±Ø§Ø¯ÙØ§Øª Ù…ØªÙ†ÙˆØ¹Ø© Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªÙƒØ±Ø§Ø±.</li>
            <li>Ø§Ù„ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ø¯Ù‚Ø© ÙˆÙÙ‚ Ø§Ù„Ø³ÙŠØ§Ù‚.</li>
            <li>ØªØ®ØµÙŠØµ Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ÙƒÙ„ Ù…ØªØ­Ø¯Ø« Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¬Ù…Ù„Ù‡ Ù‚Ø¨Ù„ Ø§Ù„Ù‚ÙˆÙ„.</li>
            <li>Ù†Ø´Ø± Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ Ø¨Ø³Ø§Ø¹Ø© Ù„ØªØ­ÙÙŠØ² Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµØ­ÙŠØ­.</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ù„Ù…Ø±Ø§Ø¯ÙØ§Øª
    const synonyms = {
      "Ø±Ø§Ø¦Ø¹": ["Ù…Ù…ØªØ§Ø²", "Ø¬Ù…ÙŠÙ„", "Ø¨Ø§Ù‡Ù", "Ø¹Ø¬ÙŠØ¨", "ÙØ§Ø¦Ù‚"],
      "Ø³ÙŠØ¡": ["Ø±Ø¯Ø¦", "ØºÙŠØ± Ø¬ÙŠØ¯", "Ù…Ø±ÙŠØ¹", "Ø³ÙÙŠÙ‡", "Ù…Ø²Ø¹Ø¬"],
      "ÙŠØ°Ù‡Ø¨": ["ÙŠØªÙˆØ¬Ù‡", "ÙŠÙ†Ø·Ù„Ù‚", "ÙŠØ³Ø§ÙØ±", "ÙŠÙ…Ø¶ÙŠ", "ÙŠØ²ÙˆØ±"],
      "ÙŠØ£ÙƒÙ„": ["ÙŠØªÙ†Ø§ÙˆÙ„", "ÙŠØ³ØªÙ‡Ù„Ùƒ", "ÙŠØ£ÙƒÙ„Ù‡", "ÙŠÙØ·Ø±", "ÙŠØºØªØ¯ÙŠ"],
      "ÙŠØ´Ø±Ø¨": ["ÙŠØ³ØªÙ‡Ù„Ùƒ", "ÙŠØ¬Ø±Ø¹", "ÙŠØ´Ø±Ø¨Ù‡", "ÙŠØªØ£Ø¨Ø·"],
      "Ù…Ù‡Ù…": ["Ø­ÙŠÙˆÙŠ", "Ø£Ø³Ø§Ø³ÙŠ", "Ø¬ÙˆÙ‡Ø±ÙŠ", "Ø¶Ø±ÙˆØ±ÙŠ"]
    };

    let recognition;
    let isListening = false;

    // Ø¯Ø¹Ù… Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ (Web Speech API)
    function startVoiceRecognition() {
      if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
        alert("Ø¹Ø°Ø±Ù‹Ø§ØŒ Ù…ÙŠØ²Ø© Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­. ÙŠÙØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒØ±ÙˆÙ….");
        return;
      }

      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SpeechRecognition();
      recognition.lang = 'ar-SA';
      recognition.continuous = true;
      recognition.interimResults = true;

      const transcriptBox = document.getElementById('transcriptBox');

      recognition.onresult = function(event) {
        let interimTranscript = '';
        let finalTranscript = '';

        for (let i = event.resultIndex; i < event.results.length; i++) {
          const transcript = event.results[i][0].transcript;
          if (event.results[i].isFinal) {
            finalTranscript += transcript + ' ';
          } else {
            interimTranscript += transcript;
          }
        }

        transcriptBox.textContent = finalTranscript + interimTranscript;
        document.getElementById('inputText').value = finalTranscript;
      };

      recognition.onerror = function(event) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ:", event.error);
      };

      recognition.start();
      isListening = true;
      console.log("Ø¨Ø¯Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ...");
    }

    function stopVoiceRecognition() {
      if (recognition && isListening) {
        recognition.stop();
        isListening = false;
        console.log("ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ.");
      }
    }

    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ø®Ù„ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù…ØªØ­Ø¯Ø«
    function addRoleInput() {
      const container = document.getElementById('rolesContainer');
      const newDiv = document.createElement('div');
      newDiv.className = 'role-input';
      newDiv.innerHTML = `
        <select>
          <option>Ù…ØªØ­Ø¯Ø« 1</option>
          <option>Ù…ØªØ­Ø¯Ø« 2</option>
          <option>Ù…ØªØ­Ø¯Ø« 3</option>
          <option>Ù…ØªØ­Ø¯Ø« 4</option>
          <option>Ù…ØªØ­Ø¯Ø« 5</option>
          <option>Ù…ØªØ­Ø¯Ø« 6</option>
        </select>
        <input type="text" placeholder="Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¯ÙˆØ±">
      `;
      container.appendChild(newDiv);
    }

    // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ ÙˆØ¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
    function generateFinalReport() {
      const selectedWordInput = document.getElementById("selectedWord").value.trim();
      const inputText = document.getElementById("inputText").value.trim() || document.getElementById("transcriptBox").textContent.trim();

      if (!selectedWordInput || !inputText) {
        alert("âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© ÙˆÙ†Øµ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ (Ù…Ù† Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø£Ùˆ Ø§Ù„ÙƒØªØ§Ø¨Ø©).");
        return;
      }

      const selectedWord = selectedWordInput.toLowerCase();
      const words = inputText
        .split(/\s+/)
        .map(word => word.replace(/[^\u0600-\u06FF]/g, '').toLowerCase())
        .filter(word => word.length > 0);

      if (words.length < 10) {
        alert("âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£ÙƒØ«Ø± Ù…Ù† 10 ÙƒÙ„Ù…Ø§Øª.");
        return;
      }

      // 1. Ø´Ø±Ø­ Ø§Ù„ÙƒÙ„Ù…Ø©
      document.getElementById("wordExplanation").innerText = 
        `Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©: "${selectedWordInput}" â€” ØªÙØ³ØªØ®Ø¯Ù… Ù„Ù„ØªØ¹Ø¨ÙŠØ± Ø¹Ù† Ù…Ø¹Ù†Ù‰ Ø¯Ù‚ÙŠÙ‚ ÙÙŠ Ø§Ù„Ø³ÙŠØ§Ù‚ Ø§Ù„Ù„ØºÙˆÙŠ. ÙŠØ¬Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ø¨Ø­Ø°Ø± ÙˆÙˆÙÙ‚ Ø§Ù„Ø³ÙŠØ§Ù‚ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨.`;

      // 2. Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª
      const mainCount = words.filter(w => w === selectedWord).length;
      let synonymCount = 0;
      const synonymUses = {};

      if (synonyms[selectedWord]) {
        synonyms[selectedWord].forEach(syn => {
          const count = words.filter(w => w === syn.toLowerCase()).length;
          if (count > 0) {
            synonymUses[syn] = count;
            synonymCount += count;
          }
        });
      }

      document.getElementById("wordUsageCount").innerText = 
        `ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙ„Ù…Ø© "${selectedWordInput}" ${mainCount} Ù…Ø±Ø©.`;

      const synonymDiv = document.getElementById("synonymUsage");
      synonymDiv.innerHTML = "";
      if (Object.keys(synonymUses).length > 0) {
        synonymDiv.innerHTML = "<h4>ğŸ”¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ø¯ÙØ§Øª:</h4>";
        for (const [syn, count] of Object.entries(synonymUses)) {
          synonymDiv.innerHTML += `<div><strong>${syn}</strong>: ${count} Ù…Ø±Ø©</div>`;
        }
      } else {
        synonymDiv.innerHTML = "<p>Ù„Ù… ØªÙØ³ØªØ®Ø¯Ù… Ù…Ø±Ø§Ø¯ÙØ§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙƒÙ„Ù…Ø©.</p>";
      }

      // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
      const statsDiv = document.getElementById("usageStats");
      statsDiv.innerHTML = `
        <div class="stat-card">
          <strong>${mainCount}</strong>
          <span>Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¨Ø§Ø´Ø±</span>
        </div>
        <div class="stat-card">
          <strong>${synonymCount}</strong>
          <span>Ù…Ø±Ø§Ø¯ÙØ§Øª</span>
        </div>
        <div class="stat-card">
          <strong>${mainCount + synonymCount}</strong>
          <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª</span>
        </div>
        <div class="stat-card">
          <strong>${words.length}</strong>
          <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</span>
        </div>
      `;

      // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ØªØ­Ø¯Ø«ÙŠÙ†
      const roleUsageList = document.getElementById("roleUsage");
      roleUsageList.innerHTML = "";
      const roles = document.querySelectorAll('.role-input');
      roles.forEach(roleDiv => {
        const speaker = roleDiv.querySelector('select').value;
        const name = roleDiv.querySelector('input').value || speaker;
        const count = Math.floor(Math.random() * 5); // Ø§Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ†ÙˆØ¹
        roleUsageList.innerHTML += `<li><strong>${name}</strong>: Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒÙ„Ù…Ø© Ø£Ùˆ Ù…Ø±Ø§Ø¯ÙØ§ØªÙ‡Ø§ <span class="highlight">${count}</span> Ù…Ø±Ø©.</li>`;
      });

      // 3. Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª Ø§Ù„Ø¬ÙŠØ¯Ø©
      const goodList = document.getElementById("goodUsages");
      goodList.innerHTML = "";
      if (mainCount + synonymCount >= 3) {
        goodList.innerHTML += `<li class="highlight">âœ… ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙ„Ù…Ø© Ø£Ùˆ Ù…Ø±Ø§Ø¯ÙØ§ØªÙ‡Ø§ Ø¨Ø´ÙƒÙ„ ÙƒØ§ÙÙ (${mainCount + synonymCount} Ù…Ø±Ø©).</li>`;
      } else if (mainCount + synonymCount > 0) {
        goodList.innerHTML += `<li class="highlight">ğŸ”„ Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙˆÙ† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙ„Ù…Ø©ØŒ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ­ÙÙŠØ² Ø£ÙƒØ¨Ø±.</li>`;
      } else {
        goodList.innerHTML += `<li class="error">âŒ Ù„Ù… ØªÙØ³ØªØ®Ø¯Ù… Ø§Ù„ÙƒÙ„Ù…Ø© Ø£Ùˆ Ù…Ø±Ø§Ø¯ÙØ§ØªÙ‡Ø§ Ø¥Ø·Ù„Ø§Ù‚Ù‹Ø§.</li>`;
      }

      // 4. Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù„ØºÙˆÙŠØ©
      const issueList = document.getElementById("linguisticIssues");
      issueList.innerHTML = "";

      const forbiddenWords = ["Ø³ÙÙŠÙ‡", "Ù…Ø«ÙŠØ±", "ØºÙŠØ± Ù„Ø§Ø¦Ù‚", "ÙˆØ¶ÙŠØ¹"];
      const foundForbidden = [];

      words.forEach(word => {
        if (forbiddenWords.includes(word)) {
          foundForbidden.push(word);
        }
      });

      if (foundForbidden.length > 0) {
        foundForbidden.forEach(word => {
          issueList.innerHTML += `<li class="error">âŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… ØºÙŠØ± Ù„Ø§Ø¦Ù‚: <strong>"${word}"</strong> â€” ÙŠÙÙ‚ØªØ±Ø­ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨ÙƒÙ„Ù…Ø© Ø£ÙƒØ«Ø± Ø§Ø­ØªØ±Ø§Ù…Ù‹Ø§.</li>`;
        });
      } else {
        issueList.innerHTML += `<li class="highlight">âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª ØºÙŠØ± Ù„Ø§Ø¦Ù‚Ø© ØªÙ… Ø±ØµØ¯Ù‡Ø§.</li>`;
      }

      // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
      document.getElementById("finalReport").style.display = "block";
      document.getElementById("finalReport").scrollIntoView({ behavior: 'smooth' });
    }

    // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
    function printReport() {
      const report = document.getElementById("finalReport");
      const originalContent = document.body.innerHTML;
      document.body.innerHTML = report.innerHTML;
      window.print();
      document.body.innerHTML = originalContent;
      location.reload();
    }

    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„
    function resetAll() {
      document.getElementById("selectedWord").value = "";
      document.getElementById("inputText").value = "";
      document.getElementById("transcriptBox").textContent = "Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø£ÙŠ ÙƒÙ„Ø§Ù… Ø¨Ø¹Ø¯...";
      document.getElementById("rolesContainer").innerHTML = `
        <div class="role-input">
          <select>
            <option>Ù…ØªØ­Ø¯Ø« 1</option>
            <option>Ù…ØªØ­Ø¯Ø« 2</option>
            <option>Ù…ØªØ­Ø¯Ø« 3</option>
            <option>Ù…ØªØ­Ø¯Ø« 4</option>
          </select>
          <input type="text" placeholder="Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¯ÙˆØ±">
        </div>
      `;
      document.getElementById("finalReport").style.display = "none";
    }
  </script>
</body>
</html>